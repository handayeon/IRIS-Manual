lag
=========

개요
----

현재 행 이전의 행의 값을 가져오는 명령어

설명
----

현재 행 이전의 행의 값을 가져오는 명령어

현재 데이터와 이전 데이터의 값을 비교 할 때 사용되면 유용한 명령어

예를들어, 선택한 컬럼의 데이터가 1,2,3,4 순서로 있을 때, 해당 데이터의 이전값 즉 null,1,2,3 의 값을 가져오는 동작을 실행

Parameters
---------

.. code-block:: none

    * | lag 값컬럼명 BY 그룹컬럼명 (AS 신규컬럼명)?

.. list-table::
   :header-rows: 1
   
   * - 이름
     - 설명
     - 필수/옵션
   * - 값컬럼명
     - 해당 컬럼의 값의 이전행을 가져오기 위한 컬럼
     - 필수
   * - 그룹컬럼명
     - 이전 행의 기준을 나타내는 컬럼, 예) 날짜 컬럼, sort된 컬럼 ...
     - 필수
   * - 신규컬럼명
     - 결과 데이터를 저장할 컬럼명, (Default: PREVIOUS_ROW_OF_값컬럼명)
     - 옵션

Examples
--------

- 예제 데이터

.. list-table::
   :header-rows: 1
   
   * - A
     - B
   * - 2020-01-01
     - 45
   * - 2020-01-02
     - 53
   * - 2020-01-03
     - 23
   * - 2020-01-04
     - 1

- 예제1
.. code-block:: none

    * | lag B BY A

.. list-table::
   :header-rows: 1

   * - A
     - B
     - PREVIOUS_ROW_OF_B
   * - 2020-01-01
     - 45
     - 
   * - 2020-01-02
     - 53
     - 45
   * - 2020-01-03
     - 23
     - 53
   * - 2020-01-04
     - 1
     - 23

- 예제2
.. code-block:: none

    * | lag B BY A AS 결과컬럼

.. list-table::
   :header-rows: 1

   * - A
     - B
     - 결과컬럼
   * - 2020-01-01
     - 45
     - 
   * - 2020-01-02
     - 53
     - 45
   * - 2020-01-03
     - 23
     - 53
   * - 2020-01-04
     - 1
     - 23
